
<!DOCTYPE html>
<html>
<head>
  <title>Edit: <%= test.title %></title>
  <link rel="stylesheet" href="/css/dashboard.css" />
  <link rel="stylesheet" href="/css/nav.css" />
</head>

<body>
  <header class="top-bar">
      <div class="top-left">
        <a href="/dashboard"><img src="/img/alphatest3.png" class="nav-logo" alt="Logo"></a>
        <h1>Test Cases</h1>
      </div>

      <div class="top-nav">
        <a href="/dashboard" class="nav-btn">Dashboard</a>
        <a href="/testcases" class="nav-btn">All Test Cases</a>
        <a href="/logout" class="nav-btn logout">Logout</a>
      </div>
    </header>
  <div class="content">

    <h1>Edit Test Case</h1>

    <form action="/testcases/<%= test._id %>/edit" method="POST" class="form-card">

      <label>Title</label>
      <input type="text" name="title" value="<%= test.title %>" required>

      <label>Description</label>
      <textarea name="description" required><%= test.description %></textarea>

      <label>Estimate</label>
      <input type="text" name="estimate" value="<%= test.estimate || '' %>">

      <label>Priority</label>
      <select name="priority">
        <option value="low" <%= test.priority === "low" ? "selected" : "" %>>Low</option>
        <option value="medium" <%= test.priority === "medium" ? "selected" : "" %>>Medium</option>
        <option value="high" <%= test.priority === "high" ? "selected" : "" %>>High</option>
        <option value="critical" <%= test.priority === "critical" ? "selected" : "" %>>Critical</option>
      </select>

      <label>Type</label>
      <select name="type">
        <option value="functional" <%= test.type === "functional" ? "selected" : "" %>>Functional</option>
        <option value="regression" <%= test.type === "regression" ? "selected" : "" %>>Regression</option>
        <option value="exploratory" <%= test.type === "exploratory" ? "selected" : "" %>>Exploratory</option>
        <option value="performance" <%= test.type === "performance" ? "selected" : "" %>>Performance</option>
      </select>

      <label>Pre-conditions</label>
      <textarea name="preconditions"><%= test.preconditions || '' %></textarea>

      <label>Steps</label>
      <textarea name="steps" required><%= test.steps %></textarea>

      <label>Expected Result</label>
      <textarea name="expectedResult" required><%= test.expectedResult %></textarea>

      <label>Labels (comma-separated)</label>
      <input type="text" name="labels" value="<%= test.labels ? test.labels.join(', ') : '' %>">

      <label>Status</label>
      <select name="status">
        <option value="not-started" <%= test.status === "not-started" ? "selected" : "" %>>Not Started</option>
        <option value="in-progress" <%= test.status === "in-progress" ? "selected" : "" %>>In Progress</option>
        <option value="passed" <%= test.status === "passed" ? "selected" : "" %>>Passed</option>
        <option value="failed" <%= test.status === "failed" ? "selected" : "" %>>Failed</option>
      </select>

      <!-- <label>Assign to User</label>
      <select name="assignedTo">
        <option value="">Unassigned</option>
          <% users.forEach(user => { %>
        <option value="<%= user._id %>"><%= user.username %></option>
          <% }) %>
      </select> -->
      <label>Assign to User</label>
      <select id="assignedTo" name="assignedTo" class="form-control">
        <option value="">Unassigned</option>
          <% users.forEach(u => { %>
        <option value="<%= u._id %>" 
        <%= test.assignedTo && test.assignedTo.equals(u._id) ? "selected" : "" %>>
        <%= u.local.username %>
        </option>
        <% }) %>
      </select>

      <br><br>
      <button class="save-btn">Save Changes</button>

    </form>

    <br>
    <a href="/testcases/<%= test._id %>" class="back-btn">⬅ Back</a>
  </div>

<footer class="site-footer">
  <p>© <%= new Date().getFullYear() %> AlphaTest — All Rights Reserved.</p>
</footer>


</body>
</html>
